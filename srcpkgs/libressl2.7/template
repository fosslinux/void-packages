# Template file for 'libressl2.7'
# exists for rust1.29-bootstrap
pkgname=libressl2.7
version=2.7.4
revision=1
build_style=gnu-configure
short_desc="Version of the TLS/crypto stack forked from OpenSSL - version 2.7"
maintainer="fosslinux <fosslinux@aussies.space>"
license="OpenSSL-License, SSLeay-License, ISC"
wrksrc="libressl-${version}"
#changelog="https://raw.githubusercontent.com/libressl-portable/portable/master/ChangeLog"
homepage="http://www.libressl.org/"
distfiles="http://ftp.openbsd.org/pub/OpenBSD/LibreSSL/libressl-${version}.tar.gz"
checksum=1e3a9fada06c1c060011470ad0ff960de28f9a0515277d7336f7e09362517da6
provides="openssl-${version}_${revision}"
replaces="openssl>=0"
conf_files="/etc/ssl/openssl.cnf /etc/ssl/x509v3.cnf"

if [ "$CROSS_BUILD" ]; then
	hostmakedepends="automake libtool"
	pre_configure() {
		autoreconf -fi
	}
fi

post_install() {
	# Use CA file from ca-certificates instead.
	rm -f ${DESTDIR}/etc/ssl/cert.pem
	ln -s certs.pem ${DESTDIR}/etc/ssl/cert.pem

	vlicense COPYING
	find ${DESTDIR}/usr/share/man/man1 -type f ! -name openssl.1 -delete
}

libcrypto43_package() {
    short_desc+=" - crypto library"
    pkg_install() {
        vmove usr/lib/libcrypto.so.*
    }
}

libssl45_package() {
    short_desc+=" - SSL/TLS library"
    pkg_install() {
        vmove usr/lib/libssl.so.*
    }
}

libtls17_package() {
    short_desc+=" - new TLS library"
    pkg_install() {
        vmove usr/lib/libtls.so.*
    }
}
