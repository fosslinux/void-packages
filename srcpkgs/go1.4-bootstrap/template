# Template file for 'go1.4-bootstrap'
pkgname=go1.4-bootstrap
version=20171003
revision=1
archs="x86_64* i686* aarch64* armv[67]l*"
wrksrc="go"
short_desc="Go Programming Language 1.4 bootstrap package"
maintainer="fosslinux <fosslinux@aussies.space>"
license="BSD-3-Clause"
homepage="https://golang.org/doc/install/source"
distfiles="https://dl.google.com/go/go1.4-bootstrap-${version}.tar.gz"
checksum=f4ff5b5eb3a3cae1c993723f3eab519c5bae18866b5e5f96fe1102f0cb5c3e52
nostrip=yes
noverifyrdeps=yes

case "${XBPS_TARGET_MACHINE}" in
	aarch64*) GOARCH=arm64 ;;
	arm*) GOARCH=arm ;;
	i686*) GOARCH=386 ;;
	x86_64*) GOARCH=amd64 ;;
	*) broken="Unsupported architecture ${XBPS_TARGET_MACHINE}" ;;
esac
export GOARCH

do_build() {
	unset GCC CC CXX LD LDFLAGS
	unset CGO_CXXFLAGS CGO_CFLAGS CGO_ENABLED

	cd src
	CGO_ENABLED=0 GOROOT="${PWD}" GOROOT_FINAL="/usr/lib/go1.4" ./make.bash
}

do_install() {
	vmkdir usr/lib/go1.4
	vcopy bin usr/lib/go1.4
	vcopy src usr/lib/go1.4
	vcopy pkg usr/lib/go1.4
	vlicense LICENSE
}
